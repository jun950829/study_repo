# 1. 동기화(Synchronization)

 동기화란 여러 프로세스나 스레드가 공유 자원(메모리, 파일, 변수 등)에 접근할 때 데이터의 일관성과 정확성을 보장하기 위한 기법입니다.

### 왜 동기화가 필요한가?
- 문제 상황 (경쟁 상태, Race Condition)

- 여러 스레드가 동시에 같은 변수에 접근하여 값을 바꾸면 예상하지 못한 결과가 발생
  - 예: 은행 계좌 출금 시 동시 접근하면 금액이 꼬일 수 있음

####  동기화 기법들

|방식|  설명  |예시|
|----|----|-|
|뮤텍스(Mutex)|  하나의 스레드만 자원 접근 허용  |pthread_mutex, synchronized (Java)|
|세마포어(Semaphore)	|  최대 N개의 스레드가 접근 가능  |sem_init, semaphore.acquire()|
| 모니터(Monitor)|  뮤텍스 + 조건 변수 포함한 고급 추상화  |Java의 synchronized, wait()/notify()|
|스핀락(Spinlock)|Lock이 풀릴 때까지 반복 검사|빠른 Lock 획득이 필요할 때|
|조건 변수|특정 조건 만족 시 wait → signal로 깨움|pthread_cond_wait, notify()|

  -  예시 (Java - synchronized)
  ```
  public class Counter {
    private int count = 0;
    
    public synchronized void increment() {
          count++;
    }
  }
  ```

-  예시 (C - pthread mutex)
```
    pthread_mutex_t lock;
    pthread_mutex_init(&lock, NULL);
    
    pthread_mutex_lock(&lock);
    // critical section
    pthread_mutex_unlock(&lock);
```

# 2. 교착상태(Deadlock)

교착상태란 둘 이상의 프로세스가 서로 자원을 기다리며 무한정 대기 상태에 빠지는 상황을 말합니다.

### 교착상태 발생 4조건 (필수 암기 ⭐️)
|조건|설명|    
|----|----|
|상호 배제(Mutual Exclusion)|자원은 한 번에 하나의 프로세스만 사용 가능|    
|점유 대기(Hold and Wait)|자원을 가진 채 다른 자원을 기다림|    
|비선점(No Preemption)|다른 프로세스가 강제로 자원 뺏을 수 없음|    
|순환 대기(Circular Wait)|자원이 순환 형태로 기다리는 구조|  

- 이 네 조건이 동시에 만족될 때만 교착 상태가 발생합니다.

- 예시
  - 프로세스 A: 프린터 → 스캐너 기다림
  - 프로세스 B: 스캐너 → 프린터 기다림
→ 서로 자원을 점유한 채 서로의 자원을 기다리므로 교착 상태 발생
  
### 교착 상태 해결 전략
|전략|설명|  비고  |
|----|----|----|
|예방(Prevention)|4조건 중 하나 이상을 아예 제거| 가장 강력하지만 비효율 가능   |
|회피(Avoidance)|발생 가능성을 미리 계산해 피함|   대표 알고리즘: 은행원 알고리즘 |
|발견(Detection)|발생 후 탐지 → 복구 시도|자원 할당 그래프 탐색|
|복구(Recovery)|프로세스 강제 종료, 자원 회수 등|자주 쓰이지 않음 (위험성 존재)|
		

### 회피 전략 - 은행원 알고리즘 (Banker's Algorithm)
- 프로세스가 자원 요청 시, 시스템이 안전 상태인지 시뮬레이션
- 안전한 상태일 때만 자원 할당
- 은행원이 돈을 빌려주는 기준과 비슷한 개념

### 동기화와 교착상태의 관계
- 동기화를 위해 락을 잘못 사용하면 교착상태가 발생할 수 있음
- 따라서 동기화는 필수지만, 락 설계는 신중하게 해야 함

### 실전에서의 예방 팁
|방법|  설명  |
|----|----|
|락 획득 순서 통일|   항상 A → B 순서로 락 획득 |
|타임아웃 사용|  일정 시간 지나면 락 포기  |
|트랜잭션 분리|  하나의 작업에서 모든 자원을 한번에 처리 |
|Lock-free 알고리즘 사용|  가능하면 락 없는 동시성 처리 방법 고려  |
	

#### 요약
|개념|핵심    포인트 |
|----|----|
|동기화|데이터의 정합성을 위해 자원 접근 제어  |
|교착상태|  자원을 서로 기다리며 무한 대기  |
|4조건|상호 배제, 점유 대기, 비선점, 순환 대기|
|예방	|락 순서 고정, 타임아웃, 세마포어 설계|
	 
	 
	
	

